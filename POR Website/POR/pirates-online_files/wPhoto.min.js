define("wPhoto",["lodash","react","core","santaProps","utils","image","zoomedImage","imageClientApi"],function(a,b,c,d,e,f,g,h){"use strict";function l(a,b){return b&&("goToLink"===a||!a)||"zoomMode"===a}function m(c,d,e,f,g,h,i,j){var k={style:{}};return k.style.width=g.width,k.style.height=g.height,l(f,e)&&(k.style.cursor="pointer"),"zoomMode"===f?a.assign(k,j(h,c,null,d)):!e||"goToLink"!==f&&f?k.parentConst=b.DOM.div:a.assign(k,i(e)),k}function n(a,b){return this.createChildComponent(this.props.compData,a,"img",b)}function o(a,b){return{id:a.id+"img",ref:"img",containerWidth:b.width,containerHeight:b.height,displayMode:k[a.compProp.displayMode]||a.compProp.displayMode,effectName:a.compProp.effectName,imageData:a.compData,usePreloader:a.usePreloader!==!1,addItemProp:a.addItemProp}}function p(b,c,d){var e;return this.state.isInZoom?(b.className=this.classSet({zoomedin:!0}),b.initialClickPosition=this.state.initialClickPosition,e=n.call(this,"core.components.ZoomedImage",b),c.onMouseLeave=t.bind(this),c.onMouseEnter=u.bind(this)):(b.className=this.classSet({zoomedout:!0}),e=n.call(this,"core.components.Image",b),c.onMouseLeave=a.noop,c.onMouseEnter=a.noop),a.assign(d,c),e}function q(a,b,c,d){var e=o(this.props,a),f={onClick:s.bind(this)};return!c||v(b,a)?n.call(this,"core.components.Image",e):p.call(this,e,f,d)}function r(b,c,d,e){var f={style:a.cloneDeep(b)};return f.style.width=c.width,f.style.height=c.height,f["data-exact-height"]=c.exactHeight,f["data-content-padding-horizontal"]=d.contentPaddingHorizontal,f["data-content-padding-vertical"]=d.contentPaddingVertical,f.title=e,f}function s(a){var b=this,c=this.state.isInZoom;c?this.refs.img.zoomOut(function(){b.setState({isInZoom:!c})}):this.setState({isInZoom:!c,initialClickPosition:{clientX:a.clientX,clientY:a.clientY}});var d=this.props.compProp.effectName&&"none"!==this.props.compProp.effectName;d&&this.registerReLayout()}function t(a){var b=this;u.call(this),this.zoomTimer=setTimeout(function(){s.apply(b,[a])},j)}function u(){clearTimeout(this.zoomTimer)}function v(a,b){return a.width<b.width||a.height<b.height}function w(a,b){var c={},d=parseInt(a.contentPaddingLeft.value||0,10)+parseInt(b.contentPaddingLeft||0,10),e=parseInt(a.contentPaddingRight.value||0,10)+parseInt(b.contentPaddingRight||0,10),f=parseInt(a.contentPaddingTop.value||0,10)+parseInt(b.contentPaddingTop||0,10),g=parseInt(a.contentPaddingBottom.value||0,10)+parseInt(b.contentPaddingBottom||0,10);return c.contentPaddingHorizontal=d+e,c.contentPaddingVertical=f+g,c}function x(a,b){var c=a.width-b.contentPaddingHorizontal,d=a.height-b.contentPaddingVertical;return{width:c>0?c:16,height:d>0?d:16}}function y(a,b){return{width:a.width+b.contentPaddingHorizontal,height:a.height+b.contentPaddingVertical,exactHeight:(a.exactHeight||a.height)+b.contentPaddingVertical}}var i=c.compMixins,j=1200,k={fitWidthStrict:h.fittingTypes.LEGACY_FIT_WIDTH,fitHeightStrict:h.fittingTypes.LEGACY_FIT_HEIGHT};return{displayName:"WPhoto",propTypes:a.assign({compData:d.Types.Component.compData.isRequired,compProp:d.Types.Component.compProp.isRequired,renderLink:d.Types.Link.renderLink.isRequired,renderImageZoomLink:d.Types.Link.renderImageZoomLink.isRequired,rootNavigationInfo:d.Types.Component.rootNavigationInfo.isRequired,id:d.Types.Component.id,structure:d.Types.Component.structure},d.santaTypesUtils.getSantaTypesByDefinition(f),d.santaTypesUtils.getSantaTypesByDefinition(g)),statics:{useSantaTypes:!0},mixins:[i.skinBasedComp,i.skinInfo,i.animationsMixin],getInitialState:function(){return this.zoomTimer=null,{isInZoom:!1}},getSkinProperties:function(){var b=this.props.structure.propertyQuery,c=this.props.compData.link||null,d=this.props.compProp.onClickBehavior,f=this.props.compProp.displayMode,g=a.pick(this.props.style,["width","height"]),h={width:this.props.compData.width,height:this.props.compData.height},i=w(this.getParams(["contentPaddingLeft","contentPaddingRight","contentPaddingBottom","contentPaddingTop"]),this.getSkinExports()),j=e.imageUtils.getContainerSize(x(g,i),h,k[f]||f),l=y(j,i),n=r(this.props.style,l,i,this.props.compData.title),o=q.call(this,j,h,"zoomAndPanMode"===d,n),p=m(this.props.compData,b,c,d,j,this.props.rootNavigationInfo,this.props.renderLink,this.props.renderImageZoomLink);return{"":n,img:o,link:p}},getDefaultSkinName:function(){return"wysiwyg.viewer.skins.photo.DefaultPhoto"}}});